# Farmland Map 使用マニュアル
- Farmland Map v1.0
- 2024-08-03
- stpete

---

https://coco-farmland-map.vercel.app/

---

## 主要機能

1. **ポリゴンデータの管理とマップ表示**: 
    - Polygon.csvにポリゴンデータを保存し、地図上に表示します。
2. **進捗データの管理**: 
    - Progress.csvに進捗状況を保存します。進捗状況は地図上のポリゴンの色に反映されます。
3. **進捗データの修正と保存**: 
    - 地図上のポリゴンにクリック/タッチまたはドロップダウンによりregion毎の進捗データを修正します。
    - 全ての進捗状況データをまとめてCSVファイルとして保存できます。
4. **ポリゴンデータの新規作成と保存**: 
    - 新たなポリゴンを作成し、CSVファイルとして保存できます。
5. **現在位置表示**: 
    - 地図が現在位置を中心に表示されるとともに、現在位置を地図上に表示します。

---

## 進捗関係ボタンの使い方

    - 画面の右側に進捗関係ボタンが並んでいます。
- **Load Initial Progress ボタン**:
  - GitHub上のProgress.csvデータを端末で取得します。これにより、各ポリゴンの色が進捗を示すようになります。
  - 進捗状況は右側の列に文字情報でも表示されます（Region番号：進捗状況）

- **Save Progress ボタン**:
  - クリックすると、端末に保存された進捗データをCSVファイルとしてダウンロードします。
  - ファイル名はProgress_{日時}.csvです。必要に応じ、GitHub上のProgress.csvを自分で更新してください。

## 進捗更新ドロップダウンリスト

- **地域選択**:
  - 進捗状況を修正したいregionを選択します。

- **進捗状態選択**:
  - 選択されたregionの新しい進捗状態を選択し、更新します。
  - 更新内容に従い、poligonの色も変わります。
  - 進捗状況には以下の選択肢があります。（）内は対応するprogressの値です。：
    - 未散布(0)
    - 散布中(1)
    - 散布済み(2)
    - 散布中止(3)

## 進捗更新マップクリック

  - 進捗変更は地図上のポリゴンをクリック/タッチすることでも実施可能です。   
  - タッチにより、poligonの色も変わります。

---

## ポリゴン作成関係ボタン類の使い方

    - 画面左下にポリゴン作成関係のボタンが並んでいます。
- **Current Location ボタン**:
  - クリックすると、地図は現在位置を中心に表示され、現在位置を地図上に青色の丸で表示します。

- **Create Polygon ボタン**:
  - ポリゴンの作成モードを開始します。
  - クリック(スマホの場合はタッチ)すると、地図上でクリックしてポリゴンの頂点を追加できます。
  - やり直す場合は、再度、Create Polygon ボタンを押してください。
  - ポリゴンの作成・保存は一つずつです。

- **Save Polygon ボタン**（ポリゴン作成モード時のみ表示）:
  - Polygon Infoを記入するためのpop up windowが画面左上に開きます。
  - Region(管理id番号)とDescriptoion情報（名前など）を記入してwindow内のsaveボタンを押します。
  - 作成したポリゴンのデータがCSV形式で保存されます。ファイル名は、polygo_{region番号}.csvです。
  - 必要に応じ、コピペでGitHub上のPolygon.csvに自分で追加してください。

---

## 主要ファイルの階層構造

- publicホルダの中にPolygonデータ、Progressデータが置かれています。ユーザー自身が管理更新するファイルです。

```
├── pages
│   └── index.tsx
├── components
│   ├── Map.tsx
│   ├── MapComponent.tsx
│   └── InitialDataLoader.tsx
├── lib
│   └── kmlParser.ts (データはcsvで供給するので非使用)
├── public
    ├── Polygon.csv (ユーザー自身が管理更新するファイル)
    └── Progress.csv (ユーザー自身が管理更新するファイル)
```

---